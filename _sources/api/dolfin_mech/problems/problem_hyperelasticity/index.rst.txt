dolfin_mech.problems.problem_hyperelasticity
============================================

.. py:module:: dolfin_mech.problems.problem_hyperelasticity

.. autoapi-nested-parse::

   Defines the Hyperelasticity class.

   Comprehensive manager for nonlinear
   finite strain simulations. It automates the setup of large-deformation
   kinematics, complex hyperelastic constitutive laws, and mixed formulations
   required for incompressible and nearly-incompressible material behavior.





Module Contents
---------------

.. py:class:: Hyperelasticity(w_incompressibility=False, mesh=None, define_facet_normals=False, domains_mf=None, boundaries_mf=None, points_mf=None, displacement_degree=None, pressure_degree=None, quadrature_degree=None, foi_degree=0, elastic_behavior=None, elastic_behaviors=None)

   Bases: :py:obj:`dolfin_mech.problems.problem.Problem`


   A general problem class for finite strain hyperelasticity.

   This class handles the setup and solution of nonlinear elasticity problems
   where the material behavior is described by a strain energy density function
   :math:`\Psi(\mathbf{C})`. It supports both compressible and incompressible
   formulations.



   **Formulation:**
   The problem minimizes the total potential energy :math:`\Pi(\mathbf{u})`:

   .. math::
       \Pi(\mathbf{u}) = \int_{\Omega_0} \Psi(\mathbf{F}) \, dV - W_{ext}

   If ``w_incompressibility`` is True, a mixed :math:`\mathbf{u}-p` formulation
   is used to enforce the constraint :math:`J = 1` (or near-incompressibility)
   via a Lagrange multiplier :math:`p`:

   .. math::
       \Pi(\mathbf{u}, p) = \int_{\Omega_0} \Psi_{dev}(\bar{\mathbf{F}}) \, dV + \int_{\Omega_0} p(J-1) \, dV - W_{ext}

   :param w_incompressibility: If True, enables the mixed formulation adding a
       pressure sub-solution to handle volumetric locking.
   :type w_incompressibility: bool
   :param mesh: The computational mesh.
   :param displacement_degree: Polynomial degree for the displacement field.
   :param elastic_behavior: Dictionary defining a single material model.
   :param elastic_behaviors: List of dictionaries for multi-material setups.


   .. py:method:: add_displacement_subsol(name=None, degree=1)

      Adds the displacement vector field sub-solution.

      :param name: Name of the variable (defaults to "U" or "u").
      :param degree: Polynomial degree of the Finite Element (usually 1 or 2).



   .. py:method:: add_pressure_subsol(name=None, degree=0)

      Adds the pressure scalar field sub-solution (Lagrange multiplier).

      This is used only when ``w_incompressibility`` is True. To satisfy the
      LBB condition (inf-sup condition) and avoid volumetric locking, the
      pressure degree is typically lower than the displacement degree (e.g., P2-P1).





   .. py:method:: set_subsols(displacement_degree=1, pressure_degree=None)

      Configures the unknown fields (displacement and optionally pressure).



   .. py:method:: set_quadrature_degree(quadrature_degree=None)

      Sets the integration order for the variational forms.

      Can be an integer, "full" (exact), or "default" (optimized).
      The "default" mode attempts to use a reduced quadrature rule that is
      computationally efficient while maintaining accuracy for standard element types.



   .. py:method:: set_kinematics(add_fois=True)

      Initializes the kinematic quantities derived from displacement.

      Calculates:
          - **F**: Deformation Gradient (:math:`\mathbf{I} + \nabla \mathbf{u}`)
          - **J**: Jacobian determinant (:math:`\det \mathbf{F}`)
          - **C**: Right Cauchy-Green deformation tensor (:math:`\mathbf{F}^T \mathbf{F}`)
          - **E**: Green-Lagrange strain tensor (:math:`0.5 (\mathbf{C} - \mathbf{I})`)

      :param add_fois: If True, registers these tensors as Fields of Interest for output.



   .. py:method:: get_subdomain_measure(subdomain_id=None)

      Returns the integration measure (dV) for a specific subdomain ID or the whole domain.



   .. py:method:: add_elasticity_operator(material_model, material_parameters, subdomain_id=None)

      Adds a standard hyperelasticity operator to the problem.

      This adds the contribution :math:`\int \Psi(\mathbf{C}) dV` to the energy,
      automatically handling the first variation to compute the residual.



   .. py:method:: add_hydrostatic_pressure_operator(subdomain_id=None)

      Adds the operator linking the pressure variable to the kinematics.



   .. py:method:: add_incompressibility_operator(subdomain_id=None)

      Adds the incompressibility constraint operator.

      Enforces :math:`J-1 = 0` (or volumetric compatibility) using the test
      function of the pressure field.



   .. py:method:: add_elasticity_operators(elastic_behaviors)

      Iterates through defined material behaviors and adds the necessary operators.

      If ``w_incompressibility`` is active, it also adds the hydrostatic pressure
      and incompressibility constraint operators.



   .. py:method:: add_point_displacement_qoi(name, coordinates, component)

      Adds a Quantity of Interest (QOI) tracking displacement at a specific point.



   .. py:method:: add_point_position_qoi(name, coordinates, component)

      Adds a QOI tracking the current spatial position (X + u) of a point.



   .. py:method:: add_deformed_volume_qoi()

      Adds a QOI for the total volume of the deformed configuration.



   .. py:method:: add_global_strain_qois()

      Adds QOIs for the volume-integrated components of the Green-Lagrange strain tensor E.



   .. py:method:: add_global_stress_qois(stress_type='cauchy')

      Adds QOIs for the volume-integrated components of the stress tensor.

      :param stress_type: The type of stress to output:
          - "Cauchy" (sigma): Spatial configuration stress.
          - "PK2" (Sigma): Material configuration stress.
          - "PK1" (P): Nominal stress.



   .. py:method:: add_global_out_of_plane_stress_qois(stress_type='PK2')

      Adds QOI for the out-of-plane stress component (ZZ) specifically.
      Useful for plane strain/stress approximations or 2D models representing 3D objects.



   .. py:method:: add_global_pressure_qoi()

      Adds QOI for the volume-integrated hydrostatic pressure P.



