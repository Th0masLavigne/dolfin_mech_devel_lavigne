dolfin_mech.problems.problem_hyperelasticity_poro
=================================================

.. py:module:: dolfin_mech.problems.problem_hyperelasticity_poro

.. autoapi-nested-parse::

   Defines the PoroHyperelasticity class.

   High-level manager for biphasic finite
   strain simulations. It models the coupled mechanics of a deformable solid
   skeleton and a fluid phase, orchestrating energy contributions from skeleton
   elasticity, mixture bulk compressibility, and pore-level fluid interactions.





Module Contents
---------------

.. py:class:: PoroHyperelasticity(mesh=None, define_facet_normals=False, domains_mf=None, boundaries_mf=None, points_mf=None, displacement_degree=1, porosity_known='Phis0', porosity_degree=None, porosity_init_val=None, porosity_init_fun=None, quadrature_degree=None, foi_degree=0, skel_behavior=None, skel_behaviors=[], bulk_behavior=None, bulk_behaviors=[], pore_behavior=None, pore_behaviors=[], w_pressure_balancing_gravity=0)

   Bases: :py:obj:`dolfin_mech.problems.problem_hyperelasticity.Hyperelasticity`


   General problem class for finite strain poro-hyperelasticity.

   This class models a biphasic continuum consisting of a deformable solid
   skeleton and a fluid phase. It is designed to handle large deformations
   where the porosity evolves as a function of the volume change (Jacobian).



   The constitutive behavior is typically split into three additive contributions to the
   strain energy density :math:`\Psi`:

   .. math::
       \Psi = \Psi_{skel}(\mathbf{C}) + \Psi_{bulk}(J, \phi_s) + \Psi_{pore}(\phi_f)

   where:
       - :math:`\Psi_{skel}`: Elastic energy of the dry solid skeleton.
       - :math:`\Psi_{bulk}`: Compressibility energy of the mixture.
       - :math:`\Psi_{pore}`: Energy contributions from pore pressure or fluid interactions.

   **Porosity Formulations:**
   The class handles two porosity descriptors:

       1. **Spatial Porosity** (:math:`\phi_s`): Solid volume fraction in the current configuration.
       2. **Lagrangian Porosity** (:math:`\Phi_{s0}`): Solid volume fraction referred to the reference volume.

   They are linked via the mass conservation constraint: :math:`\phi_s = J^{-1} \Phi_{s0}`.


   .. py:method:: set_known_and_unknown_porosity(porosity_known)

      Sets the porosity variable strategy.

      Defines the primal unknown for the solver. If `Phis0` is known, we solve for `Phis` (or derive it).
      If `phis` is known, we solve for `Phis0`.



   .. py:method:: init_known_porosity(porosity_init_val, porosity_init_fun)

      Initializes the known porosity field using a constant value or a function.



   .. py:method:: add_porosity_subsol(degree, init_val=None, init_fun=None)

      Adds the unknown porosity field to the solution space.

      Usually modeled with Discontinuous Galerkin (DG) elements (degree 0) if
      porosity is an elemental variable, or Continuous Galerkin (CG) if field
      continuity is required.



   .. py:method:: add_pressure_balancing_gravity_subsol(degree=1)

      Adds a sub-solution for the pressure field required to balance gravity.



   .. py:method:: add_lmbda_subsol(init_val=None)

      Adds a global Lagrange multiplier (vector) for translation constraints.



   .. py:method:: add_mu_subsol(init_val=None)

      Adds a global Lagrange multiplier (vector) for rotation/moment constraints.



   .. py:method:: add_gamma_subsol()

      Adds a global Lagrange multiplier (scalar) for volume/pressure constraints.



   .. py:method:: get_deformed_center_of_mass()

      Computes the center of mass in the current configuration based on the known porosity distribution.



   .. py:method:: add_deformed_center_of_mass_subsol()

      Adds a global variable tracking the deformed center of mass.



   .. py:method:: set_subsols(displacement_degree=1, porosity_degree=None, porosity_init_val=None, porosity_init_fun=None)

      Configures all sub-solutions (Displacement, Porosity, Lagrange multipliers).



   .. py:method:: set_porosity_fields()

      Sets up the dependent porosity fields based on mass conservation.

      Calculates:
          - **phis** (spatial solid fraction)
          - **Phis** (Lagrangian solid fraction scaled)

      based on the Jacobian :math:`J` and the known/unknown porosity inputs.



   .. py:method:: add_local_porosity_fois()

      Registers local porosity fields as Fields of Interest (FOI) for visualization.
      Tracks Phis0 (ref solid), Phif0 (ref fluid), phis (curr solid), phif (curr fluid).



   .. py:method:: add_Wskel_operator(material_parameters, material_scaling, subdomain_id=None)

      Adds the operator for the solid skeleton strain energy.



   .. py:method:: add_Wskel_operators(skel_behaviors)

      Adds multiple skeleton operators and registers their specific stress FOIs.



   .. py:method:: add_Wbulk_operator(material_parameters, material_scaling, subdomain_id=None)

      Adds the operator for the bulk mixture compressibility.



   .. py:method:: add_Wbulk_operators(bulk_behaviors)

      Adds multiple bulk operators and registers compressibility FOIs.



   .. py:method:: add_Wpore_operator(material_parameters, material_scaling, subdomain_id=None)

      Adds the operator for pore contributions (e.g. surface tension, pressure potentials).



   .. py:method:: add_Wpore_operators(pore_behaviors)

      Adds multiple pore behavior operators.



   .. py:method:: add_pf_operator(k_step=None, **kwargs)

      Adds an operator to define the fluid pressure field `pf` and registers it as a FOI.



   .. py:method:: add_pressure_balancing_gravity_loading_operator(k_step=None, **kwargs)

      Adds the operator solving for the pressure field that balances gravity loads.



   .. py:method:: add_global_porosity_qois()

      Registers Quantities of Interest (QOI) for integrated porosity metrics.
      Tracks total volume of solid/fluid in reference and current configurations.



   .. py:method:: add_global_stress_qois(stress_type='cauchy')

      Registers component-wise global stress QOIs (integrated over domain).

      It decomposes the total stress into:

      .. math::
          \sigma_{tot} = \sigma_{skel} + \sigma_{bulk}

      where :math:`\sigma_{bulk}` is typically related to the fluid/pore pressure contribution.

      :param stress_type: "Cauchy" (spatial, :math:`\sigma`) or "Piola"/"PK2" (material, :math:`\Sigma`).



   .. py:method:: add_global_fluid_pressure_qoi()

      Registers global fluid pressure QOI by summing contributions from all operators containing 'pf'.



